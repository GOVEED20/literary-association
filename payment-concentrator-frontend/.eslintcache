[{"E:\\literary-association\\payment-concentrator-frontend\\src\\index.js":"1","E:\\literary-association\\payment-concentrator-frontend\\src\\App.js":"2","E:\\literary-association\\payment-concentrator-frontend\\src\\components\\Register.js":"3","E:\\literary-association\\payment-concentrator-frontend\\src\\components\\ServiceForm.js":"4","E:\\literary-association\\payment-concentrator-frontend\\src\\services\\paymentService.js":"5","E:\\literary-association\\payment-concentrator-frontend\\src\\services\\retailerService.js":"6","E:\\literary-association\\payment-concentrator-frontend\\src\\css\\registerStyles.js":"7","E:\\literary-association\\payment-concentrator-frontend\\src\\components\\Toaster.js":"8","E:\\literary-association\\payment-concentrator-frontend\\src\\components\\FormField.js":"9","E:\\literary-association\\payment-concentrator-frontend\\src\\components\\Login.js":"10","E:\\literary-association\\payment-concentrator-frontend\\src\\services\\loginService.js":"11","E:\\literary-association\\payment-concentrator-frontend\\src\\css\\loginStyles.js":"12"},{"size":244,"mtime":1610109371076,"results":"13","hashOfConfig":"14"},{"size":772,"mtime":1612273205044,"results":"15","hashOfConfig":"14"},{"size":9795,"mtime":1612273205047,"results":"16","hashOfConfig":"14"},{"size":373,"mtime":1610146739146,"results":"17","hashOfConfig":"14"},{"size":467,"mtime":1610366359150,"results":"18","hashOfConfig":"14"},{"size":733,"mtime":1612273205051,"results":"19","hashOfConfig":"14"},{"size":1180,"mtime":1612273205048,"results":"20","hashOfConfig":"14"},{"size":993,"mtime":1610356258534,"results":"21","hashOfConfig":"14"},{"size":517,"mtime":1610234835991,"results":"22","hashOfConfig":"14"},{"size":2654,"mtime":1612273205045,"results":"23","hashOfConfig":"14"},{"size":879,"mtime":1612277099524,"results":"24","hashOfConfig":"14"},{"size":621,"mtime":1612273205048,"results":"25","hashOfConfig":"14"},{"filePath":"26","messages":"27","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},"elvavt",{"filePath":"29","messages":"30","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"31","messages":"32","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"33","usedDeprecatedRules":"28"},{"filePath":"34","messages":"35","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"36","messages":"37","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"38","usedDeprecatedRules":"28"},{"filePath":"39","messages":"40","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"41","messages":"42","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"43","messages":"44","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"45","messages":"46","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"47","messages":"48","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"49","usedDeprecatedRules":"28"},{"filePath":"50","messages":"51","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"52","messages":"53","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},"E:\\literary-association\\payment-concentrator-frontend\\src\\index.js",[],["54","55"],"E:\\literary-association\\payment-concentrator-frontend\\src\\App.js",[],"E:\\literary-association\\payment-concentrator-frontend\\src\\components\\Register.js",["56"],"import React, {useEffect, useState} from \"react\";\r\nimport {getAvailableServices, getPaymentServiceRegistrationFields} from \"../services/paymentService\";\r\nimport ServiceForm from \"./ServiceForm\"\r\nimport {Button, Form as BootstrapForm, Toast} from \"react-bootstrap\";\r\nimport {registerRetailer} from \"../services/retailerService\";\r\nimport {formStyle, h1Style, h4Style, mainDivStyle, serviceDivStyle, submitButtonStyle} from \"../css/registerStyles\";\r\nimport Toaster from \"./Toaster\";\r\n\r\nconst Register = () => {\r\n\r\n    const [availableServices, setAvailableServices] = useState([])\r\n    const [state, setState] = useState({})\r\n    const [checkServices, setCheckServices] = useState({})\r\n    const [formFields, setFormFields] = useState(null)\r\n    const [encryptionFields, setEncryptionFields] = useState({})\r\n    const [retailerName, setRetailerName] = useState(\"\")\r\n    const [toastData, setToastData] = useState({\r\n        show: false,\r\n        message: '',\r\n        type: '',\r\n        color: ''\r\n    })\r\n\r\n    useEffect( () => {\r\n        const getPaymentServices = async () => {\r\n            setAvailableServices(await getAvailableServices())\r\n        }\r\n        getPaymentServices().then();\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        const createState = () => {\r\n            let newState = {...state};\r\n            let newCheckServices = {...checkServices};\r\n            let newFormFields = {...formFields};\r\n            let newEncryptionFields = {...encryptionFields}\r\n            availableServices.forEach(service => {\r\n                newState = {...newState}\r\n                newState[service] = null;\r\n                newCheckServices = {...newCheckServices}\r\n                newCheckServices[service] = false;\r\n                newFormFields = {...newFormFields}\r\n                formFields[service] = null;\r\n                newEncryptionFields[service] = {...newEncryptionFields}\r\n                newEncryptionFields[service] = []\r\n            })\r\n            setState(newState)\r\n            setCheckServices(newCheckServices)\r\n            setFormFields(newFormFields)\r\n            setEncryptionFields(newEncryptionFields)\r\n        }\r\n\r\n        createState();\r\n\r\n    }, [availableServices])\r\n\r\n    const createServiceFormState = (formFields) => {\r\n        const reducer = (accumulator, currentValue) => {\r\n            const field = currentValue.name\r\n            let value = null\r\n            switch (currentValue.validationConstraints['type']) {\r\n                case \"select\":\r\n                    if (currentValue.validationConstraints['multiple']) {\r\n                        value = []\r\n                    } else {\r\n                        value = \"\"\r\n                    }\r\n                    break\r\n                case \"checkbox\":\r\n                    value = false\r\n                    break\r\n                default:\r\n                    value = \"\"\r\n            }\r\n            const newAccumulator = {...accumulator}\r\n            newAccumulator[field] = value\r\n            return newAccumulator\r\n        }\r\n        return formFields.reduce(reducer, {})\r\n    }\r\n\r\n    const changeState = (e, serviceName) => {\r\n        const newState = {...state}\r\n        const fieldName = e.target.id\r\n        const fieldValue = e.target.value\r\n        if (Array.isArray(newState[serviceName][fieldName])) {\r\n            if (fieldValue === \"\") {\r\n                return\r\n            }\r\n\r\n            if (newState[serviceName][fieldName].includes(fieldValue)) {\r\n                newState[serviceName][fieldName] = newState[serviceName][fieldName].filter(v => v !== fieldValue)\r\n            } else {\r\n                newState[serviceName][fieldName] = [...newState[serviceName][fieldName], fieldValue]\r\n            }\r\n        } else if (typeof newState[serviceName][fieldName] === \"boolean\") {\r\n            newState[serviceName][fieldName] = !newState[serviceName][fieldName]\r\n        } else {\r\n            newState[serviceName][fieldName] = fieldValue\r\n        }\r\n        setState(newState)\r\n    }\r\n\r\n    const checkChanged = (e) => {\r\n        const serviceName = e.target.id;\r\n        const newCheckServices = {...checkServices}\r\n        newCheckServices[serviceName] = e.target.checked\r\n        setCheckServices(newCheckServices)\r\n        const newFormFields = {...formFields}\r\n        const newState = {...state}\r\n        const newEncryptionFields = {...encryptionFields}\r\n        getPaymentServiceRegistrationFields(serviceName).then(res => {\r\n            newFormFields[serviceName] = res\r\n            setFormFields(newFormFields)\r\n            newState[serviceName] = createServiceFormState(res)\r\n            setState(newState)\r\n            res.forEach(field => {\r\n                const encryptionField = {\r\n                    name: field.name,\r\n                    encrypted: field.encrypted\r\n                }\r\n                if (newEncryptionFields[serviceName].filter(e => e.name === field.name).length === 0) {\r\n                    newEncryptionFields[serviceName].push(encryptionField)\r\n                }\r\n            })\r\n            setEncryptionFields(newEncryptionFields)\r\n        })\r\n    }\r\n\r\n    const onChangeNameHandler = (e) => {\r\n        setRetailerName(e.target.value)\r\n    }\r\n\r\n    const closeToaster = (message, type) => {\r\n        setTimeout(() => {\r\n            setToastData({show: false, message: message, type: type, color: ''})\r\n        }, 3000)\r\n    }\r\n\r\n    const onSubmit = async (e) => {\r\n        e.preventDefault()\r\n        const retailerData = {}\r\n        retailerData['retailerName'] = retailerName\r\n        let paymentServiceDataArray = []\r\n        availableServices.forEach(service => {\r\n            if (checkServices[service]) {\r\n                const paymentServiceData = {}\r\n                paymentServiceData['serviceName'] = service\r\n                let formFields = []\r\n                encryptionFields[service].forEach(field => {\r\n                    let regField = {\r\n                        name: field.name,\r\n                        value: state[service][field.name],\r\n                        encrypted: field.encrypted\r\n                    }\r\n                    formFields.push(regField)\r\n                })\r\n                paymentServiceData['data'] = formFields\r\n                paymentServiceDataArray.push(paymentServiceData)\r\n            }\r\n        })\r\n        retailerData['paymentServices'] = paymentServiceDataArray\r\n        registerRetailer(retailerData)\r\n            .then(res => {\r\n                setToastData({show: true, message: res, type: 'success', color: 'green'})\r\n                closeToaster(res, 'success')\r\n            })\r\n            .catch(error => {\r\n                setToastData({show: true, message: error.response.data, type: 'error', color: 'red'})\r\n                closeToaster(error.response.data, 'error')\r\n            })\r\n    }\r\n\r\n    const formatServiceName = (serviceName) => {\r\n        let formattedServiceName = serviceName.slice(0, -8)\r\n        formattedServiceName = formattedServiceName.charAt(0).toUpperCase() + formattedServiceName.slice(1)\r\n        return formattedServiceName + ' payment service'\r\n\r\n    }\r\n\r\n    document.body.style.backgroundColor = \"#010d3b\"\r\n\r\n    return (\r\n        <div>\r\n            <div className={\"container\"} style={mainDivStyle}>\r\n                <h1 style={h1Style}>Retailer registration</h1>\r\n                <BootstrapForm onSubmit={(e) => onSubmit(e)} style={formStyle}>\r\n                    <BootstrapForm.Label>Retailer name: </BootstrapForm.Label>\r\n                    <BootstrapForm.Control type=\"text\" placeholder=\"Enter retailer name\"\r\n                                           onChange={(e) => onChangeNameHandler(e)}/>\r\n                    <h4 style={h4Style}>Payment services</h4>\r\n                    <p>Choose which payment services you will provide to customers</p>\r\n                    {\r\n                        availableServices.map((service) =>\r\n                            <div key={service} style={serviceDivStyle}>\r\n                                <BootstrapForm.Check type=\"checkbox\" id={service} label={formatServiceName(service)}\r\n                                                     onChange={(e) => checkChanged(e)}/>\r\n                                {checkServices[service] &&\r\n                                    <ServiceForm\r\n                                        serviceName={service}\r\n                                        formFields={formFields[service]}\r\n                                        onChange={(e) => changeState(e, service)}/>\r\n                                }\r\n                            </div>\r\n                        )\r\n                    }\r\n                    <Button variant=\"primary\" type=\"submit\" style={submitButtonStyle}>Submit</Button>\r\n                </BootstrapForm>\r\n            </div>\r\n            {toastData.show ? <Toaster type={toastData.type} message={toastData.message} color={toastData.color}/> : null}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Register;","E:\\literary-association\\payment-concentrator-frontend\\src\\components\\ServiceForm.js",[],"E:\\literary-association\\payment-concentrator-frontend\\src\\services\\paymentService.js",["57"],"import axios from 'axios';\r\n\r\nconst PC_BASE_URL = process.env.PC_BASE_URL\r\n\r\nexport const getAvailableServices = async () => {\r\n    const response = await axios.get(`http://localhost:8080/api/payment-services`)\r\n    return response.data\r\n}\r\n\r\nexport const getPaymentServiceRegistrationFields = async (serviceName) => {\r\n    const response = await axios.get(`http://localhost:8080/api/payment-services/${serviceName}/registration-fields`)\r\n    return response.data;\r\n}","E:\\literary-association\\payment-concentrator-frontend\\src\\services\\retailerService.js",[],"E:\\literary-association\\payment-concentrator-frontend\\src\\css\\registerStyles.js",[],"E:\\literary-association\\payment-concentrator-frontend\\src\\components\\Toaster.js",[],"E:\\literary-association\\payment-concentrator-frontend\\src\\components\\FormField.js",[],"E:\\literary-association\\payment-concentrator-frontend\\src\\components\\Login.js",["58"],"import React, {useState} from \"react\";\r\nimport {Button, Form as BootstrapForm} from \"react-bootstrap\";\r\nimport {login} from '../services/loginService'\r\nimport {useHistory} from 'react-router-dom'\r\nimport {h1Style, mainDivStyle, submitButtonStyle} from \"../css/loginStyles\";\r\nimport Toaster from \"./Toaster\";\r\n\r\nconst Login = () => {\r\n\r\n    const history = useHistory()\r\n\r\n    const [username, setUsername] = useState('')\r\n    const [password, setPassword] = useState('')\r\n    const [toastData, setToastData] = useState({\r\n        show: false,\r\n        message: '',\r\n        type: '',\r\n        color: ''\r\n    })\r\n\r\n    const closeToaster = (message, type) => {\r\n        setTimeout(() => {\r\n            setToastData({show: false, message: message, type: type, color: ''})\r\n        }, 3000)\r\n    }\r\n\r\n    const onSubmit = async (e) => {\r\n        e.preventDefault()\r\n        login({username: username, password: password})\r\n            .then(res => {\r\n                history.push('/register-retailer')\r\n            })\r\n            .catch(error => {\r\n                // setToastData({show: true, message: error.response.data, type: 'error', color: 'red'})\r\n                // closeToaster(error.response.data, 'error')\r\n                console.log(error)\r\n            })\r\n    }\r\n\r\n    document.body.style.backgroundColor = \"#010d3b\"\r\n\r\n    return (\r\n        <div>\r\n            <div className={\"container\"} style={mainDivStyle}>\r\n                <BootstrapForm onSubmit={onSubmit}>\r\n                    <h1 style={h1Style}>Login</h1>\r\n                    <BootstrapForm.Group controlId=\"loginForm.username\">\r\n                        <BootstrapForm.Label>Username:</BootstrapForm.Label>\r\n                        <BootstrapForm.Control type=\"text\" placeholder=\"Enter username\"\r\n                                               onChange={({target}) => setUsername(target.value)}/>\r\n                    </BootstrapForm.Group>\r\n                    <BootstrapForm.Group controlId=\"loginForm.password\">\r\n                        <BootstrapForm.Label>Password:</BootstrapForm.Label>\r\n                        <BootstrapForm.Control type=\"password\" placeholder=\"Enter password\"\r\n                                               onChange={({target}) => setPassword(target.value)}/>\r\n                    </BootstrapForm.Group>\r\n                    <Button variant=\"primary\" type=\"submit\" style={submitButtonStyle}>Login</Button>\r\n                </BootstrapForm>\r\n            </div>\r\n            {toastData.show ?\r\n                <Toaster type={toastData.type} message={toastData.message} color={toastData.color}/> : null}\r\n        </div>\r\n\r\n    )\r\n}\r\n\r\nexport default Login;","E:\\literary-association\\payment-concentrator-frontend\\src\\services\\loginService.js",[],"E:\\literary-association\\payment-concentrator-frontend\\src\\css\\loginStyles.js",[],{"ruleId":"59","replacedBy":"60"},{"ruleId":"61","replacedBy":"62"},{"ruleId":"63","severity":1,"message":"64","line":68,"column":8,"nodeType":"65","endLine":68,"endColumn":27,"suggestions":"66"},{"ruleId":"67","severity":1,"message":"68","line":3,"column":7,"nodeType":"69","messageId":"70","endLine":3,"endColumn":18},{"ruleId":"67","severity":1,"message":"71","line":21,"column":11,"nodeType":"69","messageId":"70","endLine":21,"endColumn":23},"no-native-reassign",["72"],"no-negated-in-lhs",["73"],"react-hooks/exhaustive-deps","React Hook useEffect has missing dependencies: 'checkServices', 'encryptionFields', 'formFields', and 'state'. Either include them or remove the dependency array.","ArrayExpression",["74"],"no-unused-vars","'PC_BASE_URL' is assigned a value but never used.","Identifier","unusedVar","'closeToaster' is assigned a value but never used.","no-global-assign","no-unsafe-negation",{"desc":"75","fix":"76"},"Update the dependencies array to be: [availableServices, checkServices, encryptionFields, formFields, state]",{"range":"77","text":"78"},[2401,2420],"[availableServices, checkServices, encryptionFields, formFields, state]"]